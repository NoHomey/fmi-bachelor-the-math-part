---
title: "Домашно 2 по ВС (практикум) ФН: 45342"
lang: BG
author: Ivo Stratev
output:
  pdf_document:
    highlight: pygments
---

# Задача 1.

```{r}
library('MASS');
data("morley");
expt4 = morley[morley$Expt == 4, 3];
hist(expt4, prob=T)
```

Хистограмата изглежда като на нормално разпределение.
Нека все пак сравним графично квантилите на разпределението на данните срещу това на нормално разпределение.

```{r}
qqnorm(expt4)
qqline(expt4)
```

Сравнеието на квантилите потвърждава хипотезата, че данните са нормално разпределени. Следователно можем да намерим доверителен интервал с 97% точност за това какво е очакването на данните.

```{r}
t.test(expt4, conf.level = 0.97)
```

Както можем да видим с 97% точност очакването на данните се намира в интервала [789, 852] като средната стойност е 820.5.

# Задача 2.
Производителя твърди, че в плик с бонбони всички цветове с изключение на синия се срещат с еднаква вероятност, а той с два пъти по-голяма от останалите.
Даден ни е плик с 83 сини, 32 червени, 42 оранжеви и 48 жълти искаме да проверим дали производителя казва истината. Тоест да проверим дали е възможно пакета да бъде извадка с твърдените пропорции. За тази цел ще направим Хи-квадрат тест. Първо пресмятаме вероятността за всеки цвят:
2p + p + p + p = 1. Следователно вероятността за син бонбон е 2/5, а за всеки друг цвят 1/5.

```{r}
chisq.test(c(83, 35, 42, 48), p = c(2, 1, 1, 1) / 5)
```
Следователно вероятността производителят да казва истината е 56.5%. Тоест можем да приемем, че той не лъже.

# Задача 3.

```{r}
library("knitr");
data("birthwt");
t = table(birthwt$smoke, birthwt$low);
colnames(t) = c("normal or above", "low");
row.names(t) = c("don't smoke", "smoke");
kable(t)
barplot(t, beside = T, col= c("grey", "black"))
```

Графично забелязваме, че има връзка между теглото и тютюнопушенето.
Все пак ще проведем Хи-квадрат тест.
Нулевата хипотеза е, че липсва зависимост между теглото и тютюнопушенето. Алтернативната, че има зависимост.
```{r}
chisq.test(as.data.frame.matrix(t))
```
Нулевата хипотеза е подкрепена с вероятност 4%, за това я отхвърляме.
Следователно има зависимост между теглото и тютюнопушенето.

# Задача 4.

```{r}
data = read.csv("DomR2.csv", header = T);
```

Изследваме как всяка от колоните: x1, x2, x3 влиае на колоната y.

```{r}
plot(data$x1, data$y);
abline(lm(data$y ~ data$x1));
plot(data$x2, data$y);
abline(lm(data$y ~ data$x2));
plot(data$x3, data$y);
abline(lm(data$y ~ data$x3));
```

Забелязваме, че между x3 и y твърдо има линейна зависимост. Между x1 и y има доста слаба линейна зависимост и между x2 и y твърдо няма линейна зависимост.

Все пак пресмятаме коефициентите на корелация.

```{r}
cor(data$x1, data$y)
cor(data$x2, data$y)
cor(data$x3, data$y)
```

Стройм линеен модел ползвайки само x1 и x3.

```{r}
s = summary(lm(data$y ~ data$x1 + data$x3));
s$r.squared
s$adj.r.squared
```

Проверяваме дали ако премахнем свободния член от модела ще получим по-добър R^2 резултат.

```{r}
s = summary(lm(data$y ~ data$x1 + data$x3 - 1));
s$r.squared
s$adj.r.squared
```

И наистина има леко подобрение в R^2 резултата, така че ще използваме този модел. Тоест в модела участват променливите x1 и x3 и няма свободен член (получената права минава през центъра на координатната система).

```{r}
s
```
Очевидно е, че коефициента пред x1 не е -1, но все пак ще направим статистически тест за да се уверим в това :) .

```{r}
beta1 = s$coefficients[1, 1];
se = s$coefficients[1, 2];
a = -1;
df = s$df[2];
t = (beta1 - a) / se;
2 * pt(t, df, lower.tail = t < 0)
```
Понеже вероятността е под 1% то директно отхвърляме хипотезата, че коефициента пред x1 е -1.
